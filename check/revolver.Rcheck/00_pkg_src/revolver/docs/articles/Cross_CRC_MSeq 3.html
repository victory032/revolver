<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of colorectal adenocarcinomas • revolver</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of colorectal adenocarcinomas">
<meta property="og:description" content="revolver">
<meta property="og:image" content="caravagn.github.io/revolver/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revolver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/revolver.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/caravagn/revolver/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Cross_CRC_MSeq_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of colorectal adenocarcinomas</h1>
                        <h4 class="author">Giulio Caravagna</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagn/revolver/blob/master/vignettes/Cross_CRC_MSeq.Rmd"><code>vignettes/Cross_CRC_MSeq.Rmd</code></a></small>
      <div class="hidden name"><code>Cross_CRC_MSeq.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagn/revolver">revolver</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagn/evoverse.datasets">evoverse.datasets</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p>Cross et al. <em>The evolutionary landscape of colorectal tumorigenesis.</em> Nat Ecol Evol. 2018 2(10). <a href="https://www.ncbi.nlm.nih.gov/pubmed/30177804">PMID 30177804</a>.</p>
<ul>
<li>
<code>n=19</code> adenomas (unmatched);</li>
<li>multi-region sequencing with binary data;</li>
<li>annotated driver events from Cross et al.;</li>
</ul>
</div>
<div id="building-the-cohort" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-cohort" class="anchor"></a>Building the cohort</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_NATECOEVO_2018</span>, packages <span class="op">=</span> <span class="st">'evoverse.datasets'</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_NATECOEVO_2018</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 63 x 7</span>
<span class="co">#&gt;    patientID variantID CCF                    is.clonal is.driver Misc   cluster</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                  &lt;lgl&gt;     &lt;lgl&gt;     &lt;chr&gt;  &lt;chr&gt;  </span>
<span class="co">#&gt;  1 adenoma_1 ACVR2A    R1:1;R2:1;R3:1;R4:1;R… TRUE      TRUE      NOTHI… 1      </span>
<span class="co">#&gt;  2 adenoma_1 APC       R1:1;R2:1;R3:1;R4:1;R… TRUE      TRUE      NOTHI… 1      </span>
<span class="co">#&gt;  3 adenoma_2 APC       R1:1;R2:1;R3:1;R4:1    TRUE      TRUE      NOTHI… 1      </span>
<span class="co">#&gt;  4 adenoma_2 KRAS      R1:0;R2:0;R3:0;R4:1    FALSE     TRUE      NOTHI… 2      </span>
<span class="co">#&gt;  5 adenoma_2 ARID2     R1:0;R2:0;R3:0;R4:1    FALSE     TRUE      NOTHI… 2      </span>
<span class="co">#&gt;  6 adenoma_2 TP53      R1:1;R2:1;R3:1;R4:0    FALSE     TRUE      NOTHI… 3      </span>
<span class="co">#&gt;  7 adenoma_3 PIK3CA    R1:0;R2:0;R3:0;R4:1;R… FALSE     TRUE      NOTHI… 1      </span>
<span class="co">#&gt;  8 adenoma_3 FBXW7     R1:1;R2:1;R3:1;R4:1;R… TRUE      TRUE      NOTHI… 2      </span>
<span class="co">#&gt;  9 adenoma_3 APC       R1:1;R2:1;R3:1;R4:1;R… TRUE      TRUE      NOTHI… 2      </span>
<span class="co">#&gt; 10 adenoma_3 AKAP9     R1:0;R2:0;R3:1;R4:0;R… FALSE     TRUE      NOTHI… 3      </span>
<span class="co">#&gt; # … with 53 more rows</span>

<span class="co"># Constructor</span>
<span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span> <span class="op">=</span> <span class="fu"><a href="../reference/revolver_cohort.html">revolver_cohort</a></span><span class="op">(</span>
  <span class="va">CROSS_CRC_ADENOCARCINOMA_NATECOEVO_2018</span>, 
  MIN.CLUSTER.SIZE <span class="op">=</span> <span class="fl">0</span>, 
  annotation <span class="op">=</span> <span class="st">"Colorectal adenocarcinomas (Cross et al, PMID 30177804)"</span><span class="op">)</span>
<span class="co">#&gt;  [ REVOLVER ~ Cohort constructor ]</span>
<span class="co">#&gt; ℹ Using only driver mutations.</span>
<span class="co">#&gt; ℹ Rejecting clusters with less than 0 mutations.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── REVOLVER input data ─────────────────────────────────────────────────────────</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 63 x 9</span>
<span class="co">#&gt;    Misc   patientID variantID cluster is.driver is.clonal CCF            id     </span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;lgl&gt;     &lt;lgl&gt;     &lt;chr&gt;          &lt;chr&gt;  </span>
<span class="co">#&gt;  1 NOTHI… adenoma_1 ACVR2A    1       TRUE      TRUE      R1:1;R2:1;R3:… __mut_…</span>
<span class="co">#&gt;  2 NOTHI… adenoma_1 APC       1       TRUE      TRUE      R1:1;R2:1;R3:… __mut_…</span>
<span class="co">#&gt;  3 NOTHI… adenoma_2 APC       1       TRUE      TRUE      R1:1;R2:1;R3:… __mut_…</span>
<span class="co">#&gt;  4 NOTHI… adenoma_2 KRAS      2       TRUE      FALSE     R1:0;R2:0;R3:… __mut_…</span>
<span class="co">#&gt;  5 NOTHI… adenoma_2 ARID2     2       TRUE      FALSE     R1:0;R2:0;R3:… __mut_…</span>
<span class="co">#&gt;  6 NOTHI… adenoma_2 TP53      3       TRUE      FALSE     R1:1;R2:1;R3:… __mut_…</span>
<span class="co">#&gt;  7 NOTHI… adenoma_3 PIK3CA    1       TRUE      FALSE     R1:0;R2:0;R3:… __mut_…</span>
<span class="co">#&gt;  8 NOTHI… adenoma_3 FBXW7     2       TRUE      TRUE      R1:1;R2:1;R3:… __mut_…</span>
<span class="co">#&gt;  9 NOTHI… adenoma_3 APC       2       TRUE      TRUE      R1:1;R2:1;R3:… __mut_…</span>
<span class="co">#&gt; 10 NOTHI… adenoma_3 AKAP9     3       TRUE      FALSE     R1:0;R2:0;R3:… __mut_…</span>
<span class="co">#&gt; # … with 53 more rows, and 1 more variable: cluster_size &lt;int&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Preprocessing data (this may take some time)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ...................</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Extracting clones table ─────────────────────────────────────────────────────</span>
<span class="co">#&gt; → adenoma_1 : 2 entries, 1 clone(s).</span>
<span class="co">#&gt; → adenoma_2 : 4 entries, 3 clone(s).</span>
<span class="co">#&gt; → adenoma_3 : 8 entries, 4 clone(s).</span>
<span class="co">#&gt; → adenoma_4 : 5 entries, 3 clone(s).</span>
<span class="co">#&gt; → adenoma_5 : 3 entries, 1 clone(s).</span>
<span class="co">#&gt; → adenoma_6 : 2 entries, 1 clone(s).</span>
<span class="co">#&gt; → adenoma_7 : 3 entries, 1 clone(s).</span>
<span class="co">#&gt; → adenoma_8 : 4 entries, 1 clone(s).</span>
<span class="co">#&gt; → adenoma_9 : 1 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_1 : 3 entries, 2 clone(s).</span>
<span class="co">#&gt; → carcinoma_10 : 1 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_2 : 5 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_3 : 1 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_5 : 2 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_6 : 5 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_7 : 4 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_8 : 2 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_9_distal : 3 entries, 1 clone(s).</span>
<span class="co">#&gt; → carcinoma_9_proximal : 5 entries, 1 clone(s).</span></code></pre></div>
<p>We can check the cohort, and flag put drivers that are not recurrent.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Diagnostic</span>
<span class="fu"><a href="../reference/revolver_check_cohort.html">revolver_check_cohort</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt;      ┌──────────────────────────────────────────────────────────────────────┐</span>
<span class="co">#&gt;      │                                                                      │</span>
<span class="co">#&gt;      │   WARNING - Driver variantIDs occuring only once could be removed.   │</span>
<span class="co">#&gt;      │                                                                      │</span>
<span class="co">#&gt;      └──────────────────────────────────────────────────────────────────────┘</span>
<span class="co">#&gt; # A tibble: 9 x 7</span>
<span class="co">#&gt;   variantID numClonal p_clonal numSubclonal p_subclonal N_tot  p_tot</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 ACVR2A            1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 2 TGIF1             1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 3 SMAD3             1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 4 SOX9              1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 5 ARID2             0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 6 AKAP9             0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 7 GNAS              0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 8 SMAD4             0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 9 CHD4              0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; ┌───────────────────────────────────────────────────────────────────────────────────────────┐</span>
<span class="co">#&gt; │                                                                                           │</span>
<span class="co">#&gt; │   WARNING - Some patients have only one clone with drivers; they will just be expanded.   │</span>
<span class="co">#&gt; │                                                                                           │</span>
<span class="co">#&gt; └───────────────────────────────────────────────────────────────────────────────────────────┘</span>
<span class="co">#&gt; # A tibble: 15 x 7</span>
<span class="co">#&gt;    patientID        numBiopsies numMutations numDriverMutatio… numClonesWithDri…</span>
<span class="co">#&gt;    &lt;chr&gt;                  &lt;int&gt;        &lt;int&gt;             &lt;int&gt;             &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1                  6            2                 2                 1</span>
<span class="co">#&gt;  2 adenoma_5                  4            3                 3                 1</span>
<span class="co">#&gt;  3 adenoma_6                  2            2                 2                 1</span>
<span class="co">#&gt;  4 adenoma_7                  2            3                 3                 1</span>
<span class="co">#&gt;  5 adenoma_8                  2            4                 4                 1</span>
<span class="co">#&gt;  6 adenoma_9                  2            1                 1                 1</span>
<span class="co">#&gt;  7 carcinoma_10               5            1                 1                 1</span>
<span class="co">#&gt;  8 carcinoma_2                7            5                 5                 1</span>
<span class="co">#&gt;  9 carcinoma_3                6            1                 1                 1</span>
<span class="co">#&gt; 10 carcinoma_5                6            2                 2                 1</span>
<span class="co">#&gt; 11 carcinoma_6               13            5                 5                 1</span>
<span class="co">#&gt; 12 carcinoma_7                8            4                 4                 1</span>
<span class="co">#&gt; 13 carcinoma_8                5            2                 2                 1</span>
<span class="co">#&gt; 14 carcinoma_9_dis…           5            3                 3                 1</span>
<span class="co">#&gt; 15 carcinoma_9_pro…           5            5                 5                 1</span>
<span class="co">#&gt; # … with 2 more variables: numTruncalMutations &lt;int&gt;,</span>
<span class="co">#&gt; #   numSubclonalMutations &lt;int&gt;</span>

<span class="co"># Driver events that occur in 1 patient</span>
<span class="va">non_recurrent</span> <span class="op">=</span> <span class="fu"><a href="../reference/Stats_drivers.html">Stats_drivers</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">N_tot</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pull</span><span class="op">(</span><span class="va">variantID</span><span class="op">)</span>

<span class="co"># Remove drivers</span>
<span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span> <span class="op">=</span> <span class="fu"><a href="../reference/remove_drivers.html">remove_drivers</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span>, <span class="va">non_recurrent</span><span class="op">)</span>
<span class="co">#&gt; ── Removing driver events ──────────────────────────────────────────────────────</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 9 x 7</span>
<span class="co">#&gt;   variantID numClonal p_clonal numSubclonal p_subclonal N_tot  p_tot</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 ACVR2A            1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 2 TGIF1             1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 3 SMAD3             1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 4 SOX9              1   0.0526            0      0          1 0.0526</span>
<span class="co">#&gt; 5 ARID2             0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 6 AKAP9             0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 7 GNAS              0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 8 SMAD4             0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; 9 CHD4              0   0                 1      0.0526     1 0.0526</span>
<span class="co">#&gt; ℹ Retained 19 patients after driver removal..</span>
<span class="co">#&gt; ┌───────────────────────────────────────────────────────────────────────────────────────────┐</span>
<span class="co">#&gt; │                                                                                           │</span>
<span class="co">#&gt; │   WARNING - Some patients have only one clone with drivers; they will just be expanded.   │</span>
<span class="co">#&gt; │                                                                                           │</span>
<span class="co">#&gt; └───────────────────────────────────────────────────────────────────────────────────────────┘</span>
<span class="co">#&gt; # A tibble: 16 x 7</span>
<span class="co">#&gt;    patientID        numBiopsies numMutations numDriverMutatio… numClonesWithDri…</span>
<span class="co">#&gt;    &lt;chr&gt;                  &lt;int&gt;        &lt;int&gt;             &lt;int&gt;             &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1                  6            2                 1                 1</span>
<span class="co">#&gt;  2 adenoma_5                  4            3                 3                 1</span>
<span class="co">#&gt;  3 adenoma_6                  2            2                 2                 1</span>
<span class="co">#&gt;  4 adenoma_7                  2            3                 3                 1</span>
<span class="co">#&gt;  5 adenoma_8                  2            4                 4                 1</span>
<span class="co">#&gt;  6 adenoma_9                  2            1                 1                 1</span>
<span class="co">#&gt;  7 carcinoma_1                4            3                 2                 1</span>
<span class="co">#&gt;  8 carcinoma_10               5            1                 1                 1</span>
<span class="co">#&gt;  9 carcinoma_2                7            5                 4                 1</span>
<span class="co">#&gt; 10 carcinoma_3                6            1                 1                 1</span>
<span class="co">#&gt; 11 carcinoma_5                6            2                 2                 1</span>
<span class="co">#&gt; 12 carcinoma_6               13            5                 5                 1</span>
<span class="co">#&gt; 13 carcinoma_7                8            4                 3                 1</span>
<span class="co">#&gt; 14 carcinoma_8                5            2                 2                 1</span>
<span class="co">#&gt; 15 carcinoma_9_dis…           5            3                 3                 1</span>
<span class="co">#&gt; 16 carcinoma_9_pro…           5            5                 4                 1</span>
<span class="co">#&gt; # … with 2 more variables: numTruncalMutations &lt;int&gt;,</span>
<span class="co">#&gt; #   numSubclonalMutations &lt;int&gt;</span></code></pre></div>
</div>
<div id="constructing-mutation-trees" class="section level3">
<h3 class="hasAnchor">
<a href="#constructing-mutation-trees" class="anchor"></a>Constructing mutation trees</h3>
<p><code>revolver</code> uses the <a href="https://caravagn.github.io/ctree/">mtree</a> package to implement <em>mutation trees</em> from binary data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute the trees</span>
<span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_mutation_trees.html">compute_mutation_trees</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  Constructing Mutations Tree objects via mtree - https://caravagn.github.io/mtree/</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; Input patients.  </span>
<span class="co">#&gt; adenoma_1, adenoma_2, adenoma_3, adenoma_4, adenoma_5, adenoma_6, adenoma_7, adenoma_8, adenoma_9, carcinoma_1, carcinoma_10, carcinoma_2, carcinoma_3, carcinoma_5, carcinoma_6, carcinoma_7, carcinoma_8, carcinoma_9_distal, carcinoma_9_proximal </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_1 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 10</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5    R6</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           2 TRUE      TRUE          1     1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_2 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 3 x 8</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2           2 TRUE      FALSE         0     0     0     1</span>
<span class="co">#&gt; 2 1           1 TRUE      TRUE          1     1     1     1</span>
<span class="co">#&gt; 3 3           1 TRUE      FALSE         1     1     1     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; There are no alternatives!</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_3 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 4 x 9</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2           5 TRUE      TRUE          1     1     1     1     1</span>
<span class="co">#&gt; 2 1           1 TRUE      FALSE         0     0     0     1     1</span>
<span class="co">#&gt; 3 3           1 FALSE     FALSE         0     0     1     0     0</span>
<span class="co">#&gt; 4 4           1 FALSE     FALSE         0     1     0     0     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; There are no alternatives!</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_4 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 3 x 8</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           3 TRUE      TRUE          1     1     1     1</span>
<span class="co">#&gt; 2 2           1 TRUE      FALSE         0     0     1     0</span>
<span class="co">#&gt; 3 3           1 FALSE     FALSE         0     0     0     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; There are no alternatives!</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_5 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 8</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           3 TRUE      TRUE          1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_6 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           2 TRUE      TRUE          1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_7 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           3 TRUE      TRUE          1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_8 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           4 TRUE      TRUE          1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for adenoma_9 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           1 TRUE      TRUE          1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_1 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 2 x 8</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           2 TRUE      TRUE          1     1     1     1</span>
<span class="co">#&gt; 2 2           1 FALSE     FALSE         1     0     0     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; There are no alternatives!</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_10 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           1 TRUE      TRUE          1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_2 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 11</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5    R6    R7</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           5 TRUE      TRUE          1     1     1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_3 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 10</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5    R6</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           1 TRUE      TRUE          1     1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_5 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 10</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5    R6</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           2 TRUE      TRUE          1     1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_6 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 17</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1   R10   R11   R12   R13    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           5 TRUE      TRUE          1     1     1     1     1     1     1</span>
<span class="co">#&gt; # … with 6 more variables: R4 &lt;dbl&gt;, R5 &lt;dbl&gt;, R6 &lt;dbl&gt;, R7 &lt;dbl&gt;, R8 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   R9 &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_7 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 12</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5    R6    R7</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           4 TRUE      TRUE          1     1     1     1     1     1     1</span>
<span class="co">#&gt; # … with 1 more variable: R8 &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_8 ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           2 TRUE      TRUE          1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_9_distal ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           3 TRUE      TRUE          1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0 </span>
<span class="co">#&gt;  [ mtree ~ generate mutation trees for carcinoma_9_proximal ] </span>
<span class="co">#&gt; Sampler :  10000 (cutoff),  5000 (sampling),  100 (max store) </span>
<span class="co">#&gt; Suppes' conditions :  &gt;= </span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3    R4    R5</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1           5 TRUE      TRUE          1     1     1     1     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampler: this model has 1 node, it has trivial models.</span>
<span class="co">#&gt; ✔ Trees with non-zero sscore 1 storing 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Combinations of Information Transfer :  0</span></code></pre></div>
</div>
<div id="fitting-models-with-revolver" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-models-with-revolver" class="anchor"></a>Fitting models with REVOLVER</h3>
<p>Function <code>revolver_fit</code> implements the 2-steps REVOLVER algorithm to fit the data.</p>
<p>We use the following parameters:</p>
<ul>
<li>
<code>initial.solution = NA</code>, to sample random initial solutions for every run of EM;</li>
<li>
<code>n = 3</code>, to repeat the fit 3 times, and retain the one with lower median goodness-of-fit penalty.</li>
<li>
<code>parallel = FALSE</code>, to run serially the fits;</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span> <span class="op">=</span> <span class="fu"><a href="../reference/revolver_fit.html">revolver_fit</a></span><span class="op">(</span>
  <span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span>, 
  parallel <span class="op">=</span> <span class="cn">F</span>, 
  n <span class="op">=</span> <span class="fl">3</span>, 
  initial.solution <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
<span class="co">#&gt;  [ REVOLVER Transfer Learning fit ~ Colorectal adenocarcinomas (Cross et al, PMID 30177804) ] </span>
<span class="co">#&gt; ┌───────────────────────────────────────────────────────────────────────────────────────────┐</span>
<span class="co">#&gt; │                                                                                           │</span>
<span class="co">#&gt; │   WARNING - Some patients have only one clone with drivers; they will just be expanded.   │</span>
<span class="co">#&gt; │                                                                                           │</span>
<span class="co">#&gt; └───────────────────────────────────────────────────────────────────────────────────────────┘</span>
<span class="co">#&gt; # A tibble: 16 x 7</span>
<span class="co">#&gt;    patientID        numBiopsies numMutations numDriverMutatio… numClonesWithDri…</span>
<span class="co">#&gt;    &lt;chr&gt;                  &lt;int&gt;        &lt;int&gt;             &lt;int&gt;             &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1                  6            2                 1                 1</span>
<span class="co">#&gt;  2 adenoma_5                  4            3                 3                 1</span>
<span class="co">#&gt;  3 adenoma_6                  2            2                 2                 1</span>
<span class="co">#&gt;  4 adenoma_7                  2            3                 3                 1</span>
<span class="co">#&gt;  5 adenoma_8                  2            4                 4                 1</span>
<span class="co">#&gt;  6 adenoma_9                  2            1                 1                 1</span>
<span class="co">#&gt;  7 carcinoma_1                4            3                 2                 1</span>
<span class="co">#&gt;  8 carcinoma_10               5            1                 1                 1</span>
<span class="co">#&gt;  9 carcinoma_2                7            5                 4                 1</span>
<span class="co">#&gt; 10 carcinoma_3                6            1                 1                 1</span>
<span class="co">#&gt; 11 carcinoma_5                6            2                 2                 1</span>
<span class="co">#&gt; 12 carcinoma_6               13            5                 5                 1</span>
<span class="co">#&gt; 13 carcinoma_7                8            4                 3                 1</span>
<span class="co">#&gt; 14 carcinoma_8                5            2                 2                 1</span>
<span class="co">#&gt; 15 carcinoma_9_dis…           5            3                 3                 1</span>
<span class="co">#&gt; 16 carcinoma_9_pro…           5            5                 4                 1</span>
<span class="co">#&gt; # … with 2 more variables: numTruncalMutations &lt;int&gt;,</span>
<span class="co">#&gt; #   numSubclonalMutations &lt;int&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fitting  N = 19 patients </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 19 x 6</span>
<span class="co">#&gt;    patientID            hasTrees numTrees  maxScore  minScore combInfTransf</span>
<span class="co">#&gt;    &lt;chr&gt;                &lt;lgl&gt;       &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;         &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1            TRUE            1 1         1                     1</span>
<span class="co">#&gt;  2 adenoma_2            TRUE            1 0.0113    0.0113                1</span>
<span class="co">#&gt;  3 adenoma_3            TRUE            1 0.0000852 0.0000852             1</span>
<span class="co">#&gt;  4 adenoma_4            TRUE            1 0.00255   0.00255               1</span>
<span class="co">#&gt;  5 adenoma_5            TRUE            1 1         1                     1</span>
<span class="co">#&gt;  6 adenoma_6            TRUE            1 1         1                     1</span>
<span class="co">#&gt;  7 adenoma_7            TRUE            1 1         1                     1</span>
<span class="co">#&gt;  8 adenoma_8            TRUE            1 1         1                     1</span>
<span class="co">#&gt;  9 adenoma_9            TRUE            1 1         1                     1</span>
<span class="co">#&gt; 10 carcinoma_1          TRUE            1 0.0505    0.0505                1</span>
<span class="co">#&gt; 11 carcinoma_10         TRUE            1 1         1                     1</span>
<span class="co">#&gt; 12 carcinoma_2          TRUE            1 1         1                     1</span>
<span class="co">#&gt; 13 carcinoma_3          TRUE            1 1         1                     1</span>
<span class="co">#&gt; 14 carcinoma_5          TRUE            1 1         1                     1</span>
<span class="co">#&gt; 15 carcinoma_6          TRUE            1 1         1                     1</span>
<span class="co">#&gt; 16 carcinoma_7          TRUE            1 1         1                     1</span>
<span class="co">#&gt; 17 carcinoma_8          TRUE            1 1         1                     1</span>
<span class="co">#&gt; 18 carcinoma_9_distal   TRUE            1 1         1                     1</span>
<span class="co">#&gt; 19 carcinoma_9_proximal TRUE            1 1         1                     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Initial solution : Randomized (uniform probability) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampled solutions:  n = 3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parallel exectuion (via 'easypar') : TRUE </span>
<span class="co">#&gt; [1] "w"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  1] Expectation Maximization</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Number of Solutions   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1</span>
<span class="co">#&gt;    Combinations of Transfer   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Initialization   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # 1    :     E: OK   M:    1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |# A tibble: 19 x 9</span>
<span class="co">#&gt;    patientID         hasTrees numTrees  maxScore minScore combInfTransf Solution</span>
<span class="co">#&gt;    &lt;chr&gt;             &lt;lgl&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  2 adenoma_2         TRUE            1 0.0113     1.13e-2             1        1</span>
<span class="co">#&gt;  3 adenoma_3         TRUE            1 0.0000852  8.52e-5             1        1</span>
<span class="co">#&gt;  4 adenoma_4         TRUE            1 0.00255    2.55e-3             1        1</span>
<span class="co">#&gt;  5 adenoma_5         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  6 adenoma_6         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  7 adenoma_7         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  8 adenoma_8         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  9 adenoma_9         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 10 carcinoma_1       TRUE            1 0.0505     5.05e-2             1        1</span>
<span class="co">#&gt; 11 carcinoma_10      TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 12 carcinoma_2       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 13 carcinoma_3       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 14 carcinoma_5       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 15 carcinoma_6       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 16 carcinoma_7       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 17 carcinoma_8       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 18 carcinoma_9_dist… TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 19 carcinoma_9_prox… TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; # … with 2 more variables: converged &lt;lgl&gt;, penalty &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  2] Transfering orderings across patients</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; [1] "w"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  1] Expectation Maximization</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Number of Solutions   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1</span>
<span class="co">#&gt;    Combinations of Transfer   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Initialization   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # 1    :     E: OK   M:    1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |# A tibble: 19 x 9</span>
<span class="co">#&gt;    patientID         hasTrees numTrees  maxScore minScore combInfTransf Solution</span>
<span class="co">#&gt;    &lt;chr&gt;             &lt;lgl&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  2 adenoma_2         TRUE            1 0.0113     1.13e-2             1        1</span>
<span class="co">#&gt;  3 adenoma_3         TRUE            1 0.0000852  8.52e-5             1        1</span>
<span class="co">#&gt;  4 adenoma_4         TRUE            1 0.00255    2.55e-3             1        1</span>
<span class="co">#&gt;  5 adenoma_5         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  6 adenoma_6         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  7 adenoma_7         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  8 adenoma_8         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  9 adenoma_9         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 10 carcinoma_1       TRUE            1 0.0505     5.05e-2             1        1</span>
<span class="co">#&gt; 11 carcinoma_10      TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 12 carcinoma_2       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 13 carcinoma_3       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 14 carcinoma_5       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 15 carcinoma_6       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 16 carcinoma_7       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 17 carcinoma_8       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 18 carcinoma_9_dist… TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 19 carcinoma_9_prox… TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; # … with 2 more variables: converged &lt;lgl&gt;, penalty &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  2] Transfering orderings across patients</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; [1] "w"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  1] Expectation Maximization</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Number of Solutions   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1</span>
<span class="co">#&gt;    Combinations of Transfer   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Initialization   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # 1    :     E: OK   M:    1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |   1 |# A tibble: 19 x 9</span>
<span class="co">#&gt;    patientID         hasTrees numTrees  maxScore minScore combInfTransf Solution</span>
<span class="co">#&gt;    &lt;chr&gt;             &lt;lgl&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="co">#&gt;  1 adenoma_1         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  2 adenoma_2         TRUE            1 0.0113     1.13e-2             1        1</span>
<span class="co">#&gt;  3 adenoma_3         TRUE            1 0.0000852  8.52e-5             1        1</span>
<span class="co">#&gt;  4 adenoma_4         TRUE            1 0.00255    2.55e-3             1        1</span>
<span class="co">#&gt;  5 adenoma_5         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  6 adenoma_6         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  7 adenoma_7         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  8 adenoma_8         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt;  9 adenoma_9         TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 10 carcinoma_1       TRUE            1 0.0505     5.05e-2             1        1</span>
<span class="co">#&gt; 11 carcinoma_10      TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 12 carcinoma_2       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 13 carcinoma_3       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 14 carcinoma_5       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 15 carcinoma_6       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 16 carcinoma_7       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 17 carcinoma_8       TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 18 carcinoma_9_dist… TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; 19 carcinoma_9_prox… TRUE            1 1          1.00e+0             1        1</span>
<span class="co">#&gt; # … with 2 more variables: converged &lt;lgl&gt;, penalty &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  2] Transfering orderings across patients</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  Selecting solution with minimal median penalty</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; Solution #1 0.857142857142857 </span>
<span class="co">#&gt; Solution #2 0.857142857142857 </span>
<span class="co">#&gt; Solution #3 0.857142857142857 </span>
<span class="co">#&gt;   Best solution is # 1 </span>
<span class="co">#&gt; REVOLVER Transfer Learning fit  COMPLETED</span></code></pre></div>
</div>
<div id="computing-revolver-hierarchical-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#computing-revolver-hierarchical-clusters" class="anchor"></a>Computing REVOLVER hierarchical clusters</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span> <span class="op">=</span> <span class="fu"><a href="../reference/revolver_cluster.html">revolver_cluster</a></span><span class="op">(</span>
  <span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span>, 
  split.method <span class="op">=</span> <span class="st">'cutreeHybrid'</span>,
  min.group.size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;  [ REVOLVER Clustering - Colorectal adenocarcinomas (Cross et al, PMID 30177804) ] </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  Computing REVOLVER's evolutionary distance from the Information Transfer</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Patients : N = 19 (171 comparisons) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  Computing Hierarchical Clustering from the distance</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Clustering method ward </span>
<span class="co">#&gt;       Split method cutreeHybrid </span>
<span class="co">#&gt; Minimum group size 3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Clusters : K = 3 </span>
<span class="co">#&gt; Cluster size (n)  </span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   cluster     n</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 C1          8</span>
<span class="co">#&gt; 2 C2          7</span>
<span class="co">#&gt; 3 C3          4</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_clusters.html">plot_clusters</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span>, cutoff_trajectories <span class="op">=</span> <span class="fl">1</span>, cutoff_drivers <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span>
<span class="co">#&gt; Results may be unexpected or may change in future versions of ggplot2.</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_drivers_graph.html">plot_drivers_graph</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt;  Enrichment test for incoming edges</span>
<span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span>
<span class="co">#&gt; # A tibble: 3 x 15</span>
<span class="co">#&gt;   estimate  p.value conf.low conf.high method    alternative from  to    POS_POS</span>
<span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1      Inf  1.91e-7    10.1        Inf Fisher's… greater     GL    APC        19</span>
<span class="co">#&gt; 2      Inf  1.02e-4     5.63       Inf Fisher's… greater     APC   KRAS        7</span>
<span class="co">#&gt; 3      Inf  1.02e-4     5.63       Inf Fisher's… greater     APC   TP53        7</span>
<span class="co">#&gt; # … with 6 more variables: POS_NEG &lt;int&gt;, NEG_POS &lt;int&gt;, NEG_NEG &lt;int&gt;,</span>
<span class="co">#&gt; #   alpha_level &lt;dbl&gt;, N &lt;int&gt;, psign &lt;lgl&gt;</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-8-1.png" width="864"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_dendrogram.html">plot_dendrogram</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; Warning in if (dataClass %in% c("dendrogram", "hclust")) {: the condition has</span>
<span class="co">#&gt; length &gt; 1 and only the first element will be used</span>
<span class="co">#&gt; Warning in if (dataClass %in% c("dendrogram", "hclust")) {: the condition has</span>
<span class="co">#&gt; length &gt; 1 and only the first element will be used</span>
<span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span>
<span class="co">#&gt; Results may be unexpected or may change in future versions of ggplot2.</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_DET_index.html">plot_DET_index</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 11 x 4</span>
<span class="co">#&gt;    driver diversity     N DET_index</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 AMER1       0        1     0    </span>
<span class="co">#&gt;  2 APC         0        1     0    </span>
<span class="co">#&gt;  3 ARID1A      0        1     0    </span>
<span class="co">#&gt;  4 BRAF        0        1     0    </span>
<span class="co">#&gt;  5 FBXW7       0        1     0    </span>
<span class="co">#&gt;  6 KRAS        0        1     0    </span>
<span class="co">#&gt;  7 NRAS        0        1     0    </span>
<span class="co">#&gt;  8 TCF7L2      0        1     0    </span>
<span class="co">#&gt;  9 TP53        0        1     0    </span>
<span class="co">#&gt; 10 PIK3CA      1.52     5     0.946</span>
<span class="co">#&gt; 11 KMT2C       1.10     3     1.00</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-10-1.png" width="288"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-11-1.png" width="384"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_drivers_clonality.html">plot_drivers_clonality</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-12-1.png" width="288"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_drivers_occurrence.html">plot_drivers_occurrence</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-13-1.png" width="960"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_patient_trees.html">plot_patient_trees</a></span><span class="op">(</span><span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span>, <span class="va">CROSS_CRC_ADENOCARCINOMA_REVOLVER</span><span class="op">$</span><span class="va">patients</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Warning: Duplicated aesthetics after name standardisation: na.rm</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="Cross_CRC_MSeq_files/figure-html/unnamed-chunk-14-1.png" width="1056"><!-- and we can plot the outputs in a nice heatmap format with annotated features. In this case we want all features to be annotated, and thus we set `cutoff.features_annotation` to 1. --></p>
<!-- ```{r, eval= TRUE, message = FALSE, warning = FALSE, fig.height=8, fig.width=8} -->
<!-- revolver_plt_rclusters(fit,  -->
<!--                        cutoff.features_annotation = 1) -->
<!-- ``` -->
<!-- ## A One-step analysis -->
<!-- The breakdown of the above analysis is quite clear. So, we make available to the user a unique function ``revolver_analyzer`` that wraps all the above steps, and produce some further output not discussed in this notebook. The function carries out clustering also without the germline node, as we found that usefull in exploratory data analysis. -->
<!-- The function ``revolver_analyzer`` contains parameters that will be forwarded to the appropriate function calls. It should be evident at this point of the notebook what those parameters stand for. -->
<!-- ```{r, eval= FALSE} -->
<!-- revolver_analyzer( -->
<!--   cohort,  -->
<!--   type = 'binary', # type of data   -->
<!--   cohort.name = 'CRC-Cross', -->
<!--   folder.output = 'Drivers_all_standard_parameters',  -->
<!--   do.plots = TRUE, -->
<!--   options.trees = list( -->
<!--     sspace.cutoff = 10000,  -->
<!--     n.sampling = 5000,  -->
<!--     store.max = 200,  -->
<!--     overwrite = FALSE), -->
<!--   options.fit = list( -->
<!--     initial.solution = NA,  -->
<!--     transitive.orderings = FALSE,  -->
<!--     restarts = 10), -->
<!--   options.clustering.withGL = list( -->
<!--     transitive.closure = FALSE,  -->
<!--     min.group.size = 3,  -->
<!--     hc.method = 'ward',  -->
<!--     cutoff.features_annotation = 1,  -->
<!--     split.method = 'cutreeHybrid'), -->
<!--   options.clustering.withoutGL = list( -->
<!--     transitive.closure = FALSE,  -->
<!--     min.group.size = 3,  -->
<!--     hc.method = 'ward',  -->
<!--     cutoff.features_annotation = 1,  -->
<!--     split.method = 'cutreeDynamic') -->
<!-- ) -->
<!-- ``` -->
<!-- ## Assessing model confidence -->
<!-- The confidence of the models can be assessed with a resampling method that exploits the jackknife. The procedure is parallle, and performs ``N`` resampling steps where, at each iteration, it discards a randomly chosen subset of patients (e.g., some % of ``n``, the cohort size), and compute: -->
<!-- * the probability that two patients are clustered together; -->
<!-- * the probability that an edge is detected; -->
<!-- * the number of models that have an edge. -->
<!-- To compute these statistics the fit and clustering are re-computed for each resample; this should be done with  the same parameters used in the analysis of the full cohort. Here for example we show a computation with ``N = 50`` resamples and a leave out factor ``p=0.1`` (which means 2 patients per iteration). -->
<!-- ```{r, eval = TRUE} -->
<!-- fit =  revolver_jackknife(fit, resamples = 50, leave.out = 0.1) -->
<!-- ``` -->
<!-- Then, we can plot the jackknife statistics; we begin with the co-clustering probability (stability measure). -->
<!-- ```{r, eval = TRUE, fig.height=8, fig.width=8} -->
<!-- revolver_plt_jackknife_coclust(fit, cutoff.annotate.numbers = .6) -->
<!-- ``` -->
<!-- As well as the overall boxplot that gives us a visual information on the median stability -->
<!-- ```{r, eval = TRUE} -->
<!-- revolver_plt_jackknife_coclust_bplot(fit) -->
<!-- ``` -->
<!-- Then we look into the edges that constitute the evolutionary trajectories, and plot the edge-detection probability across resamples. -->
<!-- ```{r, eval = TRUE, fig.height=8, fig.width=8} -->
<!-- revolver_plt_jackknife_edge_prb(fit) -->
<!-- ``` -->
<!-- And we conclude with the average number of patients harbouring an edge -->
<!-- ```{r, eval = TRUE} -->
<!-- revolver_plt_jackknife_edge_counts(fit) -->
<!-- ``` -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/giuliocaravagna/">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
