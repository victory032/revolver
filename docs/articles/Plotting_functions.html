<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting functions • revolver</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting functions">
<meta property="og:description" content="">
<meta property="og:image" content="caravagn.github.io/revolver/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revolver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/revolver.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cross_CRC_MSeq.html">Analysis of colorectal adenocarcinomas</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/Getters.html">Getter functions</a>
    </li>
    <li>
      <a href="../articles/Input_formats.html">Input formats and creation of a REVOLVER cohort</a>
    </li>
    <li>
      <a href="../articles/Plotting_functions.html">Plotting functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/caravagn/revolver">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Plotting functions</h1>
                        <h4 class="author">Giulio Caravagna</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagn/revolver/blob/master/vignettes/Plotting_functions.Rmd"><code>vignettes/Plotting_functions.Rmd</code></a></small>
      <div class="hidden name"><code>Plotting_functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(revolver)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt;  [ ctree - Clone Trees in cancer ] </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Author :  Giulio Caravagna &lt;gcaravagn@gmail.com&gt; </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; GitHub :  caravagn/ctree </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; Available datasets ~ use data('xxx', package='REVOLVER_datasets') to load dataset 'xxx'</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; ◉ TRACERx_NEJM_2017 Mutations from TRACERx lung (PMID: 28445112). n = 99 patients, multi-region WES, CCF. </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; ◉ TRACERx_NEJM_2017_REVOLVER REVOLVER analysis of TRACERx_NEJM_2017. </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; ◉ YATES_BREAST_NATMED_2015 Mutations from breast cancers (PMID: 26099045). n = 50 patients, multi-region WES, binary. </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; ◉ CROSS_CRC_ADENOCARCINOMA_NATECOEVO_2018 Mutations from colorectal adenocarcinomas (PMID: 30177804). n = 19 patients, multi-region WES, binary. </span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; ◉ MSEQ_CRC_ADENOCARCINOMA_SET6 Mutations, copy number and purity from the Set6 multi-region colorectal adenocarcinoma sample (doi:10.1101/586560). n = 1 patient, multi-region WGS </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; ◉ MSEQ_CRC_ADENOCARCINOMA_SET7 Mutations, copy number and purity from the Set7 multi-region colorectal adenocarcinoma sample (doi:10.1101/586560). n = 1 patient, multi-region WGS </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;  [ Mtree - Mutation Trees in cancer ] </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; Author :  Giulio Caravagna &lt;gcaravagn@gmail.com&gt; </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; GitHub :  caravagn/mtree </span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;  [ REVOLVER - Repeated Evolution in Cancer ] </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; Author :  Giulio Caravagna &lt;gcaravagn@gmail.com&gt; </span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; GitHub :  caravagn/revolver </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;    WWW :  https://caravagn.github.io/revolver/ </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;  &gt; REVOLVER is part of the "evoverse" [https://bit.ly/2orn94e] - a collection of packages to implement Cancer Evolution analyses from cancer sequencing data.</span></a></code></pre></div>
<p>Since the new release of <code>REVOLVER</code> (&gt;= 0.3), we have implemented <a href="https://caravagn.github.io/revolver/reference/index.html">all plotting functions</a> using <a href="https://ggplot2.tidyverse.org/">ggplot2</a>.</p>
<p>All functions now return either a <code>ggplot</code> object, or a more complext figure obtained by assembling <code>ggplot</code> objects either via <code>ggarrange</code> (package <a href="https://cran.r-project.org/web/packages/ggpubr/index.html">ggpubr</a>) or <code>plot_grid</code> (package <a href="https://cran.r-project.org/web/packages/cowplot/">cowplot</a>) <code>cowplot</code>. Notice that some functions might be only applicable after fits or clusters have been computed (the package will raise errors if you try to call a function on an object that does not have the required information to create the plot).</p>
<p>In this vignette, we apply the plotting functions to one of the cohort objects released in the <code>evoverse.datasets</code> <a href="https://github.com/caravagn/evoverse.datasets">R package</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Data released in the 'evoverse.datasets'</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">'TRACERx_NEJM_2017_REVOLVER'</span>, <span class="dt">package =</span> <span class="st">'evoverse.datasets'</span>)</a></code></pre></div>
<div id="plotting-cohort-level-data" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-cohort-level-data" class="anchor"></a>Plotting cohort-level data</h1>
<p>You can plot various information about the drivers in the cohort, and the trajectories detected in the cohort. See the manual of each one of these functions to understand non-trivial plots, and how to customize the input parameters.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Plot the occurrence of drivers across the cohort.</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="../reference/plot_drivers_occurrence.html">plot_drivers_occurrence</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-3-1.png" width="1152"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Plot the barplot of drivers' occurrences (clonal vs subclonal)</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="../reference/plot_drivers_clonality.html">plot_drivers_clonality</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER) </a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Plot the  graph-alike summary statistics for the cohort drivers.</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="../reference/plot_drivers_graph.html">plot_drivers_graph</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  Enrichment test for incoming edges</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; # A tibble: 49 x 15</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;    estimate p.value conf.low conf.high method alternative from  to   </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  1     23.0 1.82e-9     8.60       Inf Fishe… greater     EGFR  TP53 </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  2     25.4 1.36e-6     4.81       Inf Fishe… greater     GL    PIK3…</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;  3     10.5 6.27e-6     4.19       Inf Fishe… greater     CDKN… TP53 </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  4     12.6 8.68e-6     3.56       Inf Fishe… greater     GL    EGFR </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;  5    Inf   1.48e-5     5.16       Inf Fishe… greater     GL    CDKN…</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;  6    Inf   1.48e-5     5.16       Inf Fishe… greater     GL    SOX2 </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;  7     19.8 1.71e-5     5.37       Inf Fishe… greater     TP53  FAT1 </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;  8    Inf   2.10e-5     9.42       Inf Fishe… greater     RASA1 TP53 </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;  9    Inf   5.99e-5    14.5        Inf Fishe… greater     BRAF  TERT </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; 10    Inf   7.41e-5     4.31       Inf Fishe… greater     GL    KEAP1</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; # … with 39 more rows, and 7 more variables: POS_POS &lt;int&gt;, POS_NEG &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; #   NEG_POS &lt;int&gt;, NEG_NEG &lt;int&gt;, alpha_level &lt;dbl&gt;, N &lt;int&gt;, psign &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; Registered S3 method overwritten by 'vegan':</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;   method     from      </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt;   rev.hclust dendextend</span></a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-5-1.png" width="1248"></p>
<p>This graph plot can be simplified reduce the entries used to generate the edges - try for instance using <code>min.occurrences = 5</code>.</p>
<p>You can also plot the penalty of the fit, and the DET index derived from that</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Plot the index of Divergent Evolutionary Trajectories</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="../reference/plot_penalty.html">plot_penalty</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;  Enrichment test for incoming edges</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; # A tibble: 49 x 15</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;    estimate p.value conf.low conf.high method alternative from  to   </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;  1     23.0 1.82e-9     8.60       Inf Fishe… greater     EGFR  TP53 </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;  2     25.4 1.36e-6     4.81       Inf Fishe… greater     GL    PIK3…</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  3     10.5 6.27e-6     4.19       Inf Fishe… greater     CDKN… TP53 </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  4     12.6 8.68e-6     3.56       Inf Fishe… greater     GL    EGFR </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;  5    Inf   1.48e-5     5.16       Inf Fishe… greater     GL    CDKN…</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;  6    Inf   1.48e-5     5.16       Inf Fishe… greater     GL    SOX2 </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;  7     19.8 1.71e-5     5.37       Inf Fishe… greater     TP53  FAT1 </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;  8    Inf   2.10e-5     9.42       Inf Fishe… greater     RASA1 TP53 </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;  9    Inf   5.99e-5    14.5        Inf Fishe… greater     BRAF  TERT </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; 10    Inf   7.41e-5     4.31       Inf Fishe… greater     GL    KEAP1</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; # … with 39 more rows, and 7 more variables: POS_POS &lt;int&gt;, POS_NEG &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; #   NEG_POS &lt;int&gt;, NEG_NEG &lt;int&gt;, alpha_level &lt;dbl&gt;, N &lt;int&gt;, psign &lt;lgl&gt;</span></a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-6-1.png" width="1152"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Plot the index of Divergent Evolutionary Trajectories</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/plot_DET_index.html">plot_DET_index</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; # A tibble: 79 x 4</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    driver diversity     N DET_index</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  1 APC            0     1         0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  2 BRAF           0     1         0</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  3 CDKN2A         0     1         0</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  4 CHEK2          0     1         0</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  5 CIC            0     1         0</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  6 CMTR2          0     1         0</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  7 COL2A1         0     1         0</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  8 CREBBP         0     1         0</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  9 CUX1           0     1         0</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; 10 DICER1         0     1         0</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; # … with 69 more rows</span></a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-7-1.png" width="1152"></p>
</div>
<div id="plotting-patients-data-and-trees" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-patients-data-and-trees" class="anchor"></a>Plotting patient’s data and trees</h1>
<p>You can plot the data and the trees of a patient.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Plot the data histogram for a patient.</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="../reference/plot_patient_CCF_histogram.html">plot_patient_CCF_histogram</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER, <span class="st">'CRUK0002'</span>)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Plot the mutation burden for a patient.</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="../reference/plot_patient_mutation_burden.html">plot_patient_mutation_burden</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER, <span class="st">'CRUK0002'</span>)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Plot the oncoprint for a patient.</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/plot_patient_oncoprint.html">plot_patient_oncoprint</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER, <span class="st">'CRUK0002'</span>)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>A full profile of the data available for a patient can be print using <code>plot_patient_data</code>. This function uses the above functions in combination with functions that are specific to the packages that implements the trees of the current cohort, in order to create other visualization of the data.</p>
<p>In the case of this cohort, since the patients have CCF-based clone trees, the reference plotting functions are from the <a href="https://caravagn.github.io/ctree/">ctree</a> package</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Plot a number of different measurements for the patient</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="../reference/plot_patient_data.html">plot_patient_data</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER, <span class="st">'CRUK0002'</span>)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-11-1.png" width="1152"></p>
<p>In a similar way, trees are plot using functions from the <a href="https://caravagn.github.io/ctree/">ctree</a> package, called by <code>REVOLVER</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Plot REVOLVER trees for a patient.</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="../reference/plot_patient_trees.html">plot_patient_trees</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER, <span class="st">'CRUK0002'</span>)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
<p>The above function plots the tree score as</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Plot REVOLVER trees for a patient.</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="../reference/plot_patient_trees_scores.html">plot_patient_trees_scores</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER, <span class="st">'CRUK0002'</span>)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-13-1.png" width="288"></p>
</div>
<div id="plotting-revolver-clusters-and-jackknife-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-revolver-clusters-and-jackknife-statistics" class="anchor"></a>Plotting REVOLVER clusters and jackknife statistics</h1>
<p>The results of using <code>REVOLVER</code> to cluster your cohort can be visualised with two functions</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Plot the heatmaps of REVOLVER"s clusters, as tiles.</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="../reference/plot_clusters.html">plot_clusters</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
<p>The top tile is patients vs trajectories, and bottom is patients vs drivers. For drivers colours reflect mean CCF/ binary values of a driver in every patient, and clonality status. For trajectories colours reflect if they are initiating or progressing, depending on the present of GL in the trajectory (GL stands for germline).</p>
<p>The dendrogram of the clusters can be visualised - notice the colours and patients’ ordering that are matched in these two functions.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Plot the dendrogram of REVOLVER"s clusters</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="../reference/plot_dendrogram.html">plot_dendrogram</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-15-1.png" width="960"></p>
<p>After jackknife, you can also plot the co-clustering probability of the patients, the clustering stability and other statistics about the trajectories.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Plot the patients' jackknife co-clustering probability</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/plot_jackknife_coclustering.html">plot_jackknife_coclustering</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-16-1.png" width="1152"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Plot the patients' jackknife cluster staability</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/plot_jackknife_cluster_stability.html">plot_jackknife_cluster_stability</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Plot the patients' jackknife trajectory frequencies.</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="../reference/plot_jackknife_trajectories_stability.html">plot_jackknife_trajectories_stability</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-18-1.png" width="480"></p>
</div>
<div id="s3-plotting-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#s3-plotting-functions" class="anchor"></a>S3 plotting functions</h1>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Plot a summary</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(TRACERx_NEJM_<span class="dv">2017</span>_REVOLVER)</a></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-19-1.png" width="480"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#plotting-cohort-level-data">Plotting cohort-level data</a></li>
      <li><a href="#plotting-patients-data-and-trees">Plotting patient’s data and trees</a></li>
      <li><a href="#plotting-revolver-clusters-and-jackknife-statistics">Plotting REVOLVER clusters and jackknife statistics</a></li>
      <li><a href="#s3-plotting-functions">S3 plotting functions</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/giuliocaravagna/">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
