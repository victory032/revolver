<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting functions â€¢ revolver</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting functions">
<meta property="og:description" content="revolver">
<meta property="og:image" content="caravagnalab.github.io/revolver/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revolver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/revolver.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cross_CRC_MSeq.html">Analysis of colorectal adenocarcinomas</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/Getters.html">Getter functions</a>
    </li>
    <li>
      <a href="../articles/Input_formats.html">Input formats and creation of a REVOLVER cohort</a>
    </li>
    <li>
      <a href="../articles/Plotting_functions.html">Plotting functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/caravagn/revolver/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting functions</h1>
                        <h4 data-toc-skip class="author">Giulio Caravagna</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagn/revolver/blob/HEAD/vignettes/Plotting_functions.Rmd" class="external-link"><code>vignettes/Plotting_functions.Rmd</code></a></small>
      <div class="hidden name"><code>Plotting_functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagn/revolver" class="external-link">revolver</a></span><span class="op">)</span></code></pre></div>
<p>Since the new release of <code>REVOLVER</code> (&gt;= 0.3), we have implemented <a href="https://caravagn.github.io/revolver/reference/index.html" class="external-link">all plotting functions</a> using <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a>.</p>
<p>All functions now return either a <code>ggplot</code> object, or a more complext figure obtained by assembling <code>ggplot</code> objects either via <code>ggarrange</code> (package <a href="https://cran.r-project.org/web/packages/ggpubr/index.html" class="external-link">ggpubr</a>) or <code>plot_grid</code> (package <a href="https://cran.r-project.org/web/packages/cowplot/" class="external-link">cowplot</a>) <code>cowplot</code>. Notice that some functions might be only applicable after fits or clusters have been computed (the package will raise errors if you try to call a function on an object that does not have the required information to create the plot).</p>
<p>In this vignette, we apply the plotting functions to one of the cohort objects released in the <code>evoverse.datasets</code> <a href="https://github.com/caravagn/evoverse.datasets" class="external-link">R package</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data released in the 'evoverse.datasets'</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'TRACERx_NEJM_2017_REVOLVER'</span>, package <span class="op">=</span> <span class="st">'evoverse.datasets'</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="plotting-cohort-level-data">Plotting cohort-level data<a class="anchor" aria-label="anchor" href="#plotting-cohort-level-data"></a>
</h2>
<p>You can plot various information about the drivers in the cohort, and the trajectories detected in the cohort. See the manual of each one of these functions to understand non-trivial plots, and how to customize the input parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the occurrence of drivers across the cohort.</span>
<span class="fu"><a href="../reference/plot_drivers_occurrence.html">plot_drivers_occurrence</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-3-1.png" width="1152"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the barplot of drivers' occurrences (clonal vs subclonal)</span>
<span class="fu"><a href="../reference/plot_drivers_clonality.html">plot_drivers_clonality</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span> </code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the  graph-alike summary statistics for the cohort drivers.</span>
<span class="fu"><a href="../reference/plot_drivers_graph.html">plot_drivers_graph</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;"> Enrichment test for incoming edges</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 49 Ã— 15</span></span>
<span class="co">#&gt;    estimate    p.value conf.low conf.high method alternative from  to    POS_POS</span>
<span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     23.0    1.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span>     8.60       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     EGFR  TP53       13</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     25.4    1.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>     4.81       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    PIK3â€¦      20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     10.5    6.27<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>     4.19       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     CDKNâ€¦ TP53       10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     12.6    8.68<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>     3.56       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    EGFR       20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    <span style="color: #BB0000;">Inf</span>      1.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     5.16       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    CDKNâ€¦      14</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    <span style="color: #BB0000;">Inf</span>      1.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     5.16       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    SOX2       14</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     19.8    1.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     5.37       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     TP53  FAT1        7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    <span style="color: #BB0000;">Inf</span>      2.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     9.42       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     RASA1 TP53        5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    <span style="color: #BB0000;">Inf</span>      5.99<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    14.5        <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     BRAF  TERT        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    <span style="color: #BB0000;">Inf</span>      7.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     4.31       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    KEAP1      12</span>
<span class="co">#&gt; <span style="color: #949494;"># â€¦ with 39 more rows, and 6 more variables: POS_NEG &lt;int&gt;, NEG_POS &lt;int&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   NEG_NEG &lt;int&gt;, alpha_level &lt;dbl&gt;, N &lt;int&gt;, psign &lt;lgl&gt;</span></span>
<span class="co">#&gt; Registered S3 method overwritten by 'vegan':</span>
<span class="co">#&gt;   method     from      </span>
<span class="co">#&gt;   rev.hclust dendextend</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-5-1.png" width="1248"></p>
<p>This graph plot can be simplified reduce the entries used to generate the edges - try for instance using <code>min.occurrences = 5</code>.</p>
<p>You can also plot the penalty of the fit, and the DET index derived from that</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the index of Divergent Evolutionary Trajectories</span>
<span class="fu"><a href="../reference/plot_penalty.html">plot_penalty</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;"> Enrichment test for incoming edges</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 49 Ã— 15</span></span>
<span class="co">#&gt;    estimate    p.value conf.low conf.high method alternative from  to    POS_POS</span>
<span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     23.0    1.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span>     8.60       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     EGFR  TP53       13</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     25.4    1.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>     4.81       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    PIK3â€¦      20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     10.5    6.27<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>     4.19       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     CDKNâ€¦ TP53       10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     12.6    8.68<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>     3.56       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    EGFR       20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    <span style="color: #BB0000;">Inf</span>      1.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     5.16       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    CDKNâ€¦      14</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    <span style="color: #BB0000;">Inf</span>      1.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     5.16       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    SOX2       14</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     19.8    1.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     5.37       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     TP53  FAT1        7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    <span style="color: #BB0000;">Inf</span>      2.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     9.42       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     RASA1 TP53        5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    <span style="color: #BB0000;">Inf</span>      5.99<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>    14.5        <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     BRAF  TERT        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    <span style="color: #BB0000;">Inf</span>      7.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span>     4.31       <span style="color: #BB0000;">Inf</span> Fisheâ€¦ greater     GL    KEAP1      12</span>
<span class="co">#&gt; <span style="color: #949494;"># â€¦ with 39 more rows, and 6 more variables: POS_NEG &lt;int&gt;, NEG_POS &lt;int&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   NEG_NEG &lt;int&gt;, alpha_level &lt;dbl&gt;, N &lt;int&gt;, psign &lt;lgl&gt;</span></span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-6-1.png" width="1152"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the index of Divergent Evolutionary Trajectories</span>
<span class="fu"><a href="../reference/plot_DET_index.html">plot_DET_index</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 79 Ã— 4</span></span>
<span class="co">#&gt;    driver diversity     N DET_index</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> APC            0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> BRAF           0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> CDKN2A         0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> CHEK2          0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> CIC            0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> CMTR2          0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> COL2A1         0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> CREBBP         0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> CUX1           0     1         0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DICER1         0     1         0</span>
<span class="co">#&gt; <span style="color: #949494;"># â€¦ with 69 more rows</span></span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-7-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="plotting-patients-data-and-trees">Plotting patientâ€™s data and trees<a class="anchor" aria-label="anchor" href="#plotting-patients-data-and-trees"></a>
</h2>
<p>You can plot the data and the trees of a patient.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the data histogram for a patient.</span>
<span class="fu"><a href="../reference/plot_patient_CCF_histogram.html">plot_patient_CCF_histogram</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, <span class="st">'CRUK0002'</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the mutation burden for a patient.</span>
<span class="fu"><a href="../reference/plot_patient_mutation_burden.html">plot_patient_mutation_burden</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, <span class="st">'CRUK0002'</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the oncoprint for a patient.</span>
<span class="fu"><a href="../reference/plot_patient_oncoprint.html">plot_patient_oncoprint</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, <span class="st">'CRUK0002'</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>A full profile of the data available for a patient can be print using <code>plot_patient_data</code>. This function uses the above functions in combination with functions that are specific to the packages that implements the trees of the current cohort, in order to create other visualization of the data.</p>
<p>In the case of this cohort, since the patients have CCF-based clone trees, the reference plotting functions are from the <a href="https://caravagn.github.io/ctree/" class="external-link">ctree</a> package</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot a number of different measurements for the patient</span>
<span class="fu"><a href="../reference/plot_patient_data.html">plot_patient_data</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, <span class="st">'CRUK0002'</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-11-1.png" width="1152"></p>
<p>In a similar way, trees are plot using functions from the <a href="https://caravagn.github.io/ctree/" class="external-link">ctree</a> package, called by <code>REVOLVER</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot REVOLVER trees for a patient.</span>
<span class="fu"><a href="../reference/plot_patient_trees.html">plot_patient_trees</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, <span class="st">'CRUK0002'</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
<p>The above function plots the tree score as</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot REVOLVER trees for a patient.</span>
<span class="fu"><a href="../reference/plot_patient_trees_scores.html">plot_patient_trees_scores</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, <span class="st">'CRUK0002'</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-13-1.png" width="288"></p>
</div>
<div class="section level2">
<h2 id="plotting-revolver-clusters-and-jackknife-statistics">Plotting REVOLVER clusters and jackknife statistics<a class="anchor" aria-label="anchor" href="#plotting-revolver-clusters-and-jackknife-statistics"></a>
</h2>
<p>The results of using <code>REVOLVER</code> to cluster your cohort can be visualised with two functions</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the heatmaps of REVOLVER"s clusters, as tiles.</span>
<span class="fu"><a href="../reference/plot_clusters.html">plot_clusters</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
<p>The top tile is patients vs trajectories, and bottom is patients vs drivers. For drivers colours reflect mean CCF/ binary values of a driver in every patient, and clonality status. For trajectories colours reflect if they are initiating or progressing, depending on the present of GL in the trajectory (GL stands for germline).</p>
<p>The dendrogram of the clusters can be visualised - notice the colours and patientsâ€™ ordering that are matched in these two functions.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the dendrogram of REVOLVER"s clusters</span>
<span class="fu"><a href="../reference/plot_dendrogram.html">plot_dendrogram</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-15-1.png" width="960"></p>
<p>You can also compute the number of trajectories per cluster, and their frequency.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the trajectories detected in at least 10 patients per cluster</span>
<span class="fu"><a href="../reference/plot_trajectories_per_cluster.html">plot_trajectories_per_cluster</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, min_counts <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-16-1.png" width="1152"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Plot the trajectories detected in at least 30% patients per cluster</span>
<span class="fu"><a href="../reference/plot_trajectories_per_cluster.html">plot_trajectories_per_cluster</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span>, min_counts <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> 
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span>
<span class="co">#&gt; â†’ min_counts in [0,1], interpreting that as a proportion.</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-16-2.png" width="1152"></p>
<p>After jackknife, you can also plot the co-clustering probability of the patients, the clustering stability and other statistics about the trajectories.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the patients' jackknife co-clustering probability</span>
<span class="fu"><a href="../reference/plot_jackknife_coclustering.html">plot_jackknife_coclustering</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-17-1.png" width="1152"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the patients' jackknife cluster staability</span>
<span class="fu"><a href="../reference/plot_jackknife_cluster_stability.html">plot_jackknife_cluster_stability</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot the patients' jackknife trajectory frequencies.</span>
<span class="fu"><a href="../reference/plot_jackknife_trajectories_stability.html">plot_jackknife_trajectories_stability</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-19-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="s3-plotting-functions">S3 plotting functions<a class="anchor" aria-label="anchor" href="#s3-plotting-functions"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot a summary</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">TRACERx_NEJM_2017_REVOLVER</span><span class="op">)</span></code></pre></div>
<p><img src="Plotting_functions_files/figure-html/unnamed-chunk-20-1.png" width="480"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.caravagnalab.org/" class="external-link">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
